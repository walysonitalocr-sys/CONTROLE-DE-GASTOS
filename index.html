// PROJECT: meu-controle-de-gastos (Vite + React)
// README.md

/*
README
======
Projeto: Meu Controle de Gastos ‚Äî vers√£o inicial (uso pessoal)
Tecnologias: React + Vite, TailwindCSS, Recharts, Framer Motion
Armazenamento inicial: LocalStorage
Objetivo: c√≥digo base pronto para rodar e com as principais funcionalidades: dashboard, adicionar/editar/excluir transa√ß√µes, gr√°ficos e tema claro/escuro.

Instru√ß√µes r√°pidas:
1. Instalar depend√™ncias: npm install
2. Rodar em desenvolvimento: npm run dev
3. Gerar build: npm run build

Arquivos inclu√≠dos neste √∫nico documento (copie para a estrutura de pastas mostrada):
- package.json
- vite.config.js
- tailwind.config.cjs
- postcss.config.cjs
- index.html
- src/main.jsx
- src/App.jsx
- src/styles/index.css
- src/components/Dashboard.jsx
- src/components/TransactionForm.jsx
- src/components/TransactionList.jsx
- src/components/ThemeToggle.jsx
- src/utils/storage.js
- src/data/categories.js
- public/favicon.ico
*/

// FILE: package.json
{
  "name": "meu-controle-de-gastos",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "recharts": "^2.4.0",
    "framer-motion": "^10.12.16"
  },
  "devDependencies": {
    "@vitejs/plugin-react": "^4.0.0",
    "autoprefixer": "^10.4.14",
    "postcss": "^8.4.24",
    "tailwindcss": "^3.4.8",
    "vite": "^5.0.0"
  }
}

// FILE: vite.config.js
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
})

// FILE: tailwind.config.cjs
module.exports = {
  content: ["./index.html", "./src/**/*.{js,jsx,ts,tsx}"],
  theme: {
    extend: {},
  },
  plugins: [],
}

// FILE: postcss.config.cjs
module.exports = {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
}

// FILE: index.html
<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Meu Controle de Gastos</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>

// FILE: src/main.jsx
import React from 'react'
import { createRoot } from 'react-dom/client'
import App from './App'
import './styles/index.css'

createRoot(document.getElementById('root')).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
)

// FILE: src/App.jsx
import React, { useEffect, useState } from 'react'
import Dashboard from './components/Dashboard'
import TransactionForm from './components/TransactionForm'
import TransactionList from './components/TransactionList'
import ThemeToggle from './components/ThemeToggle'
import { loadTransactions, saveTransactions } from './utils/storage'

export default function App() {
  const [transactions, setTransactions] = useState([])
  const [editing, setEditing] = useState(null)

  useEffect(() => {
    const tx = loadTransactions()
    setTransactions(tx)
  }, [])

  useEffect(() => {
    saveTransactions(transactions)
  }, [transactions])

  function addTransaction(tx) {
    setTransactions(prev => [tx, ...prev])
  }

  function updateTransaction(updated) {
    setTransactions(prev => prev.map(t => (t.id === updated.id ? updated : t)))
    setEditing(null)
  }

  function deleteTransaction(id) {
    setTransactions(prev => prev.filter(t => t.id !== id))
  }

  return (
    <div className="min-h-screen bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors">
      <div className="max-w-4xl mx-auto p-4">
        <header className="flex items-center justify-between mb-4">
          <h1 className="text-2xl font-bold">Meu Controle de Gastos</h1>
          <div className="flex gap-2 items-center">
            <ThemeToggle />
          </div>
        </header>

        <main className="grid grid-cols-1 md:grid-cols-3 gap-4">
          <section className="md:col-span-2 space-y-4">
            <Dashboard transactions={transactions} />
            <TransactionList transactions={transactions} onEdit={setEditing} onDelete={deleteTransaction} />
          </section>

          <aside className="md:col-span-1">
            <TransactionForm onAdd={addTransaction} onUpdate={updateTransaction} editing={editing} />
          </aside>
        </main>

        <footer className="mt-8 text-center text-sm text-gray-500 dark:text-gray-400">Vers√£o pessoal ‚Ä¢ Salvo localmente no seu navegador</footer>
      </div>
    </div>
  )
}

// FILE: src/styles/index.css
@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --accent: 59 130 246; /* rgb values for modern accent usage */
}

/* small helpers */
.body-fade-enter { opacity: 0; }

// FILE: src/data/categories.js
export const categories = [
  { id: 'alimentacao', name: 'Alimenta√ß√£o' },
  { id: 'transporte', name: 'Transporte' },
  { id: 'lazer', name: 'Lazer' },
  { id: 'moradia', name: 'Moradia' },
  { id: 'saude', name: 'Sa√∫de' },
  { id: 'outros', name: 'Outros' },
]

// FILE: src/utils/storage.js
const KEY = 'meu_controle_gastos_v1'

export function loadTransactions() {
  try {
    const raw = localStorage.getItem(KEY)
    if (!raw) return sampleData()
    return JSON.parse(raw)
  } catch (e) {
    console.error('Erro ao carregar transa√ß√µes', e)
    return []
  }
}

export function saveTransactions(data) {
  try {
    localStorage.setItem(KEY, JSON.stringify(data))
  } catch (e) {
    console.error('Erro ao salvar transa√ß√µes', e)
  }
}

function sampleData() {
  return [
    { id: 't1', type: 'expense', category: 'alimentacao', amount: 45.5, date: '2025-10-25', description: 'Almo√ßo' },
    { id: 't2', type: 'income', category: 'outros', amount: 1200, date: '2025-10-01', description: 'Sal√°rio' },
    { id: 't3', type: 'expense', category: 'transporte', amount: 15.0, date: '2025-10-20', description: 'Uber' },
  ]
}

// FILE: src/components/Dashboard.jsx
import React, { useMemo } from 'react'
import { PieChart, Pie, Cell, ResponsiveContainer, BarChart, Bar, XAxis, YAxis, Tooltip } from 'recharts'
import { categories } from '../data/categories'

const COLORS = ["#60a5fa", "#f97316", "#34d399", "#f87171", "#a78bfa", "#eab308"]

export default function Dashboard({ transactions }) {
  const total = useMemo(() => transactions.reduce((s, t) => t.type === 'income' ? s + t.amount : s - t.amount, 0), [transactions])

  const byCategory = useMemo(() => {
    const map = {}
    categories.forEach(c => (map[c.id] = 0))
    transactions.forEach(t => {
      if (t.type === 'expense') map[t.category] = (map[t.category] || 0) + t.amount
    })
    return Object.entries(map).map(([key, value]) => ({ name: categories.find(c => c.id === key)?.name || key, value }))
  }, [transactions])

  const monthly = useMemo(() => {
    const map = {}
    transactions.forEach(t => {
      const m = t.date.slice(0,7)
      map[m] = (map[m] || 0) + (t.type === 'income' ? t.amount : -t.amount)
    })
    return Object.entries(map).sort().map(([month, value]) => ({ month, value }))
  }, [transactions])

  return (
    <div className="bg-white dark:bg-gray-800 p-4 rounded-2xl shadow">
      <div className="flex items-center justify-between mb-4">
        <div>
          <div className="text-sm text-gray-500 dark:text-gray-300">Saldo</div>
          <div className={`text-2xl font-bold ${total >= 0 ? 'text-green-600' : 'text-red-500'}`}>R$ {total.toFixed(2)}</div>
        </div>
      </div>

      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div className="h-56">
          <ResponsiveContainer width="100%" height="100%">
            <PieChart>
              <Pie data={byCategory} dataKey="value" nameKey="name" outerRadius={80} label>
                {byCategory.map((entry, index) => (
                  <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />
                ))}
              </Pie>
            </PieChart>
          </ResponsiveContainer>
        </div>

        <div className="h-56">
          <ResponsiveContainer width="100%" height="100%">
            <BarChart data={monthly}>
              <XAxis dataKey="month" />
              <YAxis />
              <Tooltip />
              <Bar dataKey="value" />
            </BarChart>
          </ResponsiveContainer>
        </div>
      </div>
    </div>
  )
}

// FILE: src/components/TransactionForm.jsx
import React, { useEffect, useState } from 'react'
import { categories } from '../data/categories'
import { v4 as uuidv4 } from 'uuid'
import { motion } from 'framer-motion'

export default function TransactionForm({ onAdd, editing, onUpdate }) {
  const [form, setForm] = useState({ type: 'expense', category: 'alimentacao', amount: '', date: '', description: '' })

  useEffect(() => {
    if (editing) {
      setForm({ ...editing })
    }
  }, [editing])

  function handleChange(e) {
    const { name, value } = e.target
    setForm(prev => ({ ...prev, [name]: value }))
  }

  function submit(e) {
    e.preventDefault()
    const payload = {
      ...form,
      id: form.id || uuidv4(),
      amount: Number(form.amount),
      date: form.date || new Date().toISOString().slice(0,10)
    }
    if (editing) onUpdate(payload)
    else onAdd(payload)
    setForm({ type: 'expense', category: 'alimentacao', amount: '', date: '', description: '' })
  }

  return (
    <motion.form initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} className="bg-white dark:bg-gray-800 p-4 rounded-2xl shadow space-y-3" onSubmit={submit}>
      <h2 className="font-semibold">Nova transa√ß√£o</h2>

      <div className="grid grid-cols-2 gap-2">
        <select name="type" value={form.type} onChange={handleChange} className="p-2 rounded border">
          <option value="expense">Despesa</option>
          <option value="income">Receita</option>
        </select>

        <select name="category" value={form.category} onChange={handleChange} className="p-2 rounded border">
          {categories.map(c => <option key={c.id} value={c.id}>{c.name}</option>)}
        </select>
      </div>

      <input name="amount" value={form.amount} onChange={handleChange} placeholder="Valor (ex: 45.50)" className="w-full p-2 rounded border" />
      <input name="date" type="date" value={form.date} onChange={handleChange} className="w-full p-2 rounded border" />
      <input name="description" value={form.description} onChange={handleChange} placeholder="Descri√ß√£o (opcional)" className="w-full p-2 rounded border" />

      <div className="flex gap-2">
        <button className="flex-1 p-2 rounded bg-sky-500 text-white" type="submit">{editing ? 'Atualizar' : 'Adicionar'}</button>
      </div>
    </motion.form>
  )
}

// FILE: src/components/TransactionList.jsx
import React from 'react'
import { categories } from '../data/categories'
import { motion } from 'framer-motion'

function catName(id) { return categories.find(c => c.id === id)?.name || id }

export default function TransactionList({ transactions, onEdit, onDelete }) {
  return (
    <div className="bg-white dark:bg-gray-800 p-4 rounded-2xl shadow">
      <h3 className="font-semibold mb-2">Hist√≥rico</h3>
      <div className="space-y-2 max-h-72 overflow-auto">
        {transactions.map(t => (
          <motion.div key={t.id} initial={{ opacity: 0 }} animate={{ opacity: 1 }} className="flex items-center justify-between p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700">
            <div>
              <div className="text-sm font-medium">{t.description || catName(t.category)}</div>
              <div className="text-xs text-gray-500">{catName(t.category)} ‚Ä¢ {t.date}</div>
            </div>
            <div className="flex items-center gap-2">
              <div className={`${t.type === 'income' ? 'text-green-600' : 'text-red-500'} font-semibold`}>R$ {Number(t.amount).toFixed(2)}</div>
              <button onClick={() => onEdit(t)} className="text-sm text-blue-500">Editar</button>
              <button onClick={() => onDelete(t.id)} className="text-sm text-red-500">Excluir</button>
            </div>
          </motion.div>
        ))}
      </div>
    </div>
  )
}

// FILE: src/components/ThemeToggle.jsx
import React, { useEffect, useState } from 'react'

export default function ThemeToggle() {
  const [dark, setDark] = useState(() => localStorage.getItem('theme') === 'dark')

  useEffect(() => {
    const root = document.documentElement
    if (dark) root.classList.add('dark')
    else root.classList.remove('dark')
    localStorage.setItem('theme', dark ? 'dark' : 'light')
  }, [dark])

  return (
    <button onClick={() => setDark(d => !d)} className="p-2 rounded bg-gray-200 dark:bg-gray-700">
      {dark ? 'üåô' : '‚òÄÔ∏è'}
    </button>
  )
}

// FILE: public/favicon.ico
/* placeholder: adicione seu favicon aqui */

// END OF FILES
